{
  "name": "mongodb-source-connector",
  "config": {
    "connector.class": "com.mongodb.kafka.connect.MongoSourceConnector",
    "tasks.max": "1",
    "connection.uri": "mongodb://admin:admin@192.168.0.10:27017,192.168.0.10:27018,192.168.0.10:27019/mydatabase?replicaSet=rs0",
    "database": "mydatabase",
    "topic.prefix": "searchdata",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "false",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter.schemas.enable": "true",
    "output.format.value": "schema",
    "copy.existing": "true",
    "output.json.formatter": "com.mongodb.kafka.connect.source.json.formatter.ExtendedJson",
    "output.schema.value": "{\"type\":\"record\",\"name\":\"MongoDocument\",\"namespace\":\"com.example\",\"fields\":[{\"name\":\"_id\",\"type\":{\"type\":\"record\",\"name\":\"IdRecord\",\"fields\":[{\"name\":\"_id\",\"type\":\"string\"},{\"name\":\"copyingData\",\"type\":\"boolean\"}]}},{\"name\":\"documentKey\",\"type\":{\"type\":\"record\",\"name\":\"DocumentKeyRecord\",\"fields\":[{\"name\":\"_id\",\"type\":\"string\"}]}},{\"name\":\"fullDocument\",\"type\":{\"type\":\"record\",\"name\":\"FullDocumentRecord\",\"fields\":[{\"name\":\"body\",\"type\":\"string\"},{\"name\":\"time\",\"type\":\"long\"}]}},{\"name\":\"ns\",\"type\":{\"type\":\"record\",\"name\":\"NamespaceRecord\",\"fields\":[{\"name\":\"db\",\"type\":\"string\"},{\"name\":\"coll\",\"type\":\"string\"}]}}]}",
    "transforms": "ExtractField",
    "transforms.ExtractField.type": "org.apache.kafka.connect.transforms.ExtractField$Key",
    "transforms.ExtractField.field": "$oid",
    "pipeline": "[{\"$match\":{\"$and\":[{\"ns.coll\":{\"$regex\":\/^(users|posts)$/}}]}},{\"$project\":{\"fullDocument._id\":0, \"fullDocument.userid\": 0, \"fullDocument.__v\": 0, \"operationType\": 0, \"clusterTime\": 0, \"wallTime\": 0}}]"
  }
}




#    "transforms": "ExtractField",
#    "transforms.ExtractField.type": "org.apache.kafka.connect.transforms.ExtractField$Value",
#    "transforms.ExtractField.field": "fullDocument"


# This file: https://docs.confluent.io/platform/7.7/installation/configuration/connect/source-connect-configs.html

# Converter
# https://www.confluent.io/blog/kafka-connect-deep-dive-converters-serialization-explained/


# Transform
# https://docs.confluent.io/platform/current/connect/transforms/extractfield.html
# https://docs.confluent.io/cloud/current/connectors/single-message-transforms.html#extract-field

#, {\"$set\": {\"_id\": {\"$getField\": {\"field\": \"$oid\", \"input\": \"$_id._id\"}}}}