{
  "name": "mongodb-source-connector",
  "config": {
    "connector.class": "com.mongodb.kafka.connect.MongoSourceConnector",
    "tasks.max": "1",
    "connection.uri": "mongodb://admin:admin@192.168.0.10:27017,192.168.0.10:27018,192.168.0.10:27019/mydatabase?replicaSet=rs0",
    "database": "mydatabase",
    "collection": "posts",
    "topic.prefix": "sposts",
    "copy.existing": "true",
    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "true",
    "output.format.key": "schema",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter.schemas.enable": "true",
    "output.format.value": "schema",
    "output.json.formatter": "com.mongodb.kafka.connect.source.json.formatter.SimplifiedJson",
    "output.schema.key": "{\"type\":\"record\",\"name\":\"MyRecord\",\"namespace\":\"com.example\",\"fields\":[{\"name\":\"_id\",\"type\":{\"type\":\"record\",\"name\":\"IdWrapper\",\"fields\":[{\"name\":\"_id\",\"type\":\"string\"},{\"name\":\"copyingData\",\"type\":[\"null\",\"boolean\"],\"default\":null}]}}]}",
    "output.schema.value": "{\"type\":\"record\",\"name\":\"PostValueSchema\",\"namespace\":\"com.mynodeapp\",\"fields\":[{\"name\":\"_id\",\"type\":{\"type\":\"record\",\"name\":\"IdRecord\",\"fields\":[{\"name\":\"_id\",\"type\":\"string\"},{\"name\":\"copyingData\",\"type\":\"boolean\"}]}},{\"name\":\"documentKey\",\"type\":{\"type\":\"record\",\"name\":\"DocumentKeyRecord\",\"fields\":[{\"name\":\"_id\",\"type\":\"string\"}]}},{\"name\":\"fullDocument\",\"type\":{\"type\":\"record\",\"name\":\"FullDocumentRecord\",\"fields\":[{\"name\":\"body\",\"type\":\"string\"},{\"name\":\"time\",\"type\":\"long\"}]}},{\"name\":\"ns\",\"type\":{\"type\":\"record\",\"name\":\"NamespaceRecord\",\"fields\":[{\"name\":\"db\",\"type\":\"string\"},{\"name\":\"coll\",\"type\":\"string\"}]}}]}",
    "pipeline": "[{\"$project\":{\"fullDocument._id\":0, \"fullDocument.userid\": 0, \"fullDocument.__v\": 0, \"operationType\": 0, \"clusterTime\": 0, \"wallTime\": 0}}]",
    "transforms": "flattenKey,extractKey,flattenValue,renameValue,filterValue",
    "transforms.flattenKey.type": "org.apache.kafka.connect.transforms.Flatten$Key",
    "transforms.flattenKey.delimiter": ".",
    "transforms.extractKey.type": "org.apache.kafka.connect.transforms.ExtractField$Key",
    "transforms.extractKey.field": "_id._id",
    "transforms.flattenValue.type": "org.apache.kafka.connect.transforms.Flatten$Value",
    "transforms.flattenValue.delimiter": ".",
    "transforms.renameValue.type": "org.apache.kafka.connect.transforms.ReplaceField$Value",
    "transforms.renameValue.renames": "fullDocument.body:body,fullDocument.time:time,ns.coll:collection,_id._id:mongo_id",
    "transforms.filterValue.type": "org.apache.kafka.connect.transforms.ReplaceField$Value",
    "transforms.filterValue.whitelist": "mongo_id,body,time,operation,collection"
  }
}

# This file: https://docs.confluent.io/platform/7.7/installation/configuration/connect/source-connect-configs.html

# MongoDB connector:
# https://www.mongodb.com/docs/kafka-connector/current/quick-start/

# Converter
# https://www.confluent.io/blog/kafka-connect-deep-dive-converters-serialization-explained/

# Transform
# https://docs.confluent.io/platform/current/connect/transforms/extractfield.html
# https://docs.confluent.io/cloud/current/connectors/single-message-transforms.html#extract-field
